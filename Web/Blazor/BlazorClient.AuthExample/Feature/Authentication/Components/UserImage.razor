@using System.Security.Claims
@inherits FluxorComponent
@inject NavigationManager NavigationManager
@inject IState<AuthState> State

@if (State.Value.IsAuthenticated)
{
    if (IsClickable)
    {
        <MudTooltip Text="Profile">
            <MudImage
                Height="@Height"
                Class="rounded-circle"
                Style="cursor: pointer"
                Src="@GetImageSource()"
                @onclick="GoToProfile">
            </MudImage>
        </MudTooltip>
    }
    else
    {
        <MudImage Height="@Height" Class="rounded-circle" Src="@GetImageSource()"></MudImage>
    }
}

@code{

    [Parameter]
    public int Height { get; set; } = 40;

    [Parameter]
    public bool IsClickable { get; set; } = true;

    string? GetImageSource()
    {
        return State.Value.Claims.FirstOrDefault(x => x.Type.ToLower().Equals("picture"))?.Value;
    }

    private void GoToProfile()
    {
        NavigationManager.NavigateTo("/profile");
    }

}